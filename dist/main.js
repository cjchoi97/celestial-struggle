!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dist/",i(i.s=1)}([function(t,e,i){},function(t,e,i){"use strict";i.r(e),i.d(e,"game",(function(){return c}));i(0);var s=class{constructor(t){this.projectileImg=new Image,this.projectileImg.src=t.img,this.x=t.x,this.y=t.y,this.width=10,this.height=20,this.dx=0,this.dy=t.dy,this.ctx=t.ctx,this.draw=this.draw.bind(this),this.detectHit=this.detectHit.bind(this),this.type=t.type}detectHit(){if(this.hitbox=[this.x,this.x+this.width,this.y+this.height,this.y],"player"===this.type){if(c.enemies)for(let t=0;t<c.enemies.length;t++)if(c.enemies[t]){const e=c.enemies[t].hitBox();this.y<e[2]&&this.x>=e[0]&&this.hitbox[1]<=e[1]&&!(this.hitbox[2]<e[3])&&(console.log("enemy hit by player bullet"),c.removeEnemy(t))}}else if("enemy"===this.type&&c.player){const t=c.player.hitBox();this.hitbox[2]>t[3]&&this.hitbox[0]>=t[0]&&this.hitbox[1]<=t[1]&&!(this.hitbox[3]>t[2])&&(c.player.lives--,c.player.updateLivesDisplay(),0===c.player.lives&&(console.log("WE HAVE LOST"),c.playerProjectiles=[],c.pause()),c.player.recenter(),console.log("player hit by enemy bullet"))}}draw(){this.y+=this.dy,this.ctx.drawImage(this.projectileImg,this.x,this.y,this.width,this.height),this.detectHit(),this.y}};var h=class{constructor(t){this.ctx=t,this.playerImg=new Image,this.playerImg.src="./src/assets/spaceship.png",this.height=50,this.width=50,this.playerImg.onload=()=>this.draw(),this.x=this.ctx.canvas.width/2.2,this.y=this.ctx.canvas.height-50,this.draw=this.draw.bind(this),this.dx=0,this.dy=0,this.lives=3,this.fireProjectile=this.fireProjectile.bind(this)}recenter(){this.x=this.ctx.canvas.width/2.2,this.y=this.ctx.canvas.height-50}hitBox(){return[this.x,this.x+this.width,this.y+this.height,this.y]}moveHorizontally(t){this.dx=t}moveVertically(t){this.dy=t}fireProjectile(){return new s({x:this.x+21,y:this.y,dy:-5,ctx:this.ctx,img:"./src/assets/basic-projectile.png",type:"player"})}draw(){let t=this.x+this.dx,e=this.y+this.dy;t<0&&(t=0),t>this.ctx.canvas.width-this.width&&(t=this.ctx.canvas.width-this.width),e<0&&(e=0),e>this.ctx.canvas.height-this.height&&(e=this.ctx.canvas.height-this.height),this.x=t,this.y=e,this.ctx.drawImage(this.playerImg,this.x,this.y,this.width,this.height)}updateLivesDisplay(){const t=document.getElementById("lives-display");t&&(t.textContent="Lives: "+this.lives)}};var r=class{constructor(t){this.ctx=t,this.canvasHeight=t.canvas.height,this.canvasWidth=t.canvas.width,this.stars=[],this.generateStars(150),this.draw=this.draw.bind(this)}generateStars(t){for(let e=0;e<t;e++)this.stars.push({x:Math.random()*this.canvasWidth,y:Math.random()*this.canvasHeight,radius:1.5*Math.random()+.5,speed:.3*Math.random()+.1,brightness:.8*Math.random()+.2,color:this.getStarColor()})}getStarColor(){const t=["rgba(255, 255, 255, 0.8)","rgba(210, 230, 255, 0.8)","rgba(255, 255, 210, 0.8)"];return t[Math.floor(Math.random()*t.length)]}draw(){const t=this.ctx.createLinearGradient(0,0,0,this.canvasHeight);t.addColorStop(0,"#000000"),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight);for(let t=0;t<this.stars.length;t++){const e=this.stars[t];this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.radius,0,2*Math.PI),this.ctx.fillStyle=e.color,this.ctx.fill(),e.y+=e.speed,e.y>this.canvasHeight&&(e.y=0,e.x=Math.random()*this.canvasWidth)}this.drawNebula(100,150,200,"rgba(70, 50, 120, 0.1)"),this.drawNebula(400,300,250,"rgba(50, 100, 120, 0.1)")}drawNebula(t,e,i,s){const h=this.ctx.createRadialGradient(t,e,0,t,e,i);h.addColorStop(0,s),h.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.fillStyle=h,this.ctx.fillRect(t-i,e-i,2*i,2*i)}};var n=class{constructor(t){this.ctx=t,this.keyDownHandler=this.keyDownHandler.bind(this),this.keyUpHandler=this.keyUpHandler.bind(this),window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("keyup",this.keyUpHandler)}keyDownHandler(t){c.player&&("d"===t.key?c.player.moveHorizontally(5):"a"===t.key?c.player.moveHorizontally(-5):"w"===t.key?c.player.moveVertically(-5):"s"===t.key?c.player.moveVertically(5):"p"===t.key&&!1===c.gameOnGoing?(document.getElementById("modal").style.display="none",c.start()):"r"===t.key&&(c.pause(),c.reset(),c.start(),document.getElementById("end-modal").style.display="none"))}keyUpHandler(t){clearInterval(this.keydown),c.player&&("d"==t.key||"a"==t.key?c.player.moveHorizontally(0):("w"===t.key||"s"===t.key)&&c.player.moveVertically(0))}};var a=class{constructor(t,e){this.ctx=t,this.time=0,this.enemyImg=new Image,this.enemyImg.src=e.img,this.id=e.id,this.height=e.height,this.width=e.width,this.x=e.x,this.y=e.y,this.dy=e.dy,this.enemyImg.onload=()=>this.draw(),this.draw=this.draw.bind(this),this.fireProjectile=this.fireProjectile.bind(this),this.selfTimer=this.selfTimer.bind(this),this.detectCollision=this.detectCollision.bind(this),this.projectiles=[]}selfTimer(){this.time++}hitBox(){return[this.x,this.x+this.width,this.y+this.height,this.y]}detectCollision(){const t=this.x,e=this.x+this.width,i=this.y+this.height,s=this.y,h=c.player.hitBox(),r=h[0],n=h[1],a=h[2];i>h[3]&&(r>t&&r<e||n<e&&n>t)&&s<a&&(r>t&&r<e||n<e&&n>t)&&(console.log("player and enemy collide"),c.removeEnemy(this.id),c.player.lives--,c.player.updateLivesDisplay(),0===c.player.lives&&c.pause(),c.player.recenter())}fireProjectile(){return new s({x:this.x+30,y:this.y+70,dy:2,ctx:this.ctx,img:"./src/assets/enemy-projectile.png",type:"enemy"})}draw(){this.y+=this.dy,this.ctx.drawImage(this.enemyImg,this.x,this.y,this.width,this.height),this.projectiles.map(t=>t.draw()),this.detectCollision(),this.y>550&&c.removeEnemy(this.id)}};var o=class{constructor(t){this.enemies=t}};var l=function(t){const e=[],i=t.canvas.width;for(let s=0;s<100;s++){const h=new a(t,{img:"./src/assets/enemy-ship.png",height:70,width:70,x:Math.floor(Math.random()*Math.floor(i-70)),y:-3e3*Math.random()-100,dy:1,id:s});e.push(h)}return new o(e)};var d=class{constructor(t,e){this.canvas=t,this.ctx=e,this.background=new r(this.ctx),this.player=new h(this.ctx),this.playerProjectiles=[],this.enemyProjectiles=[],this.draw=this.draw.bind(this),this.setupControls(),this.levels=[l],this.levelidx=0,this.startTime=0,this.stunTime=0,this.gameOnGoing=!1,this.gameFinished=!1,this.setupLevel()}reset(){this.background=new r(this.ctx),this.player=new h(this.ctx),this.player.updateLivesDisplay(),this.playerProjectiles=[],this.draw=this.draw.bind(this),this.setupControls();for(let t=0;t<this.enemies.lengthl;t++)delete this.enemies[t];this.enemies=[],this.levels=[l],this.levelidx=0,this.startTime=0,this.gameOnGoing=!1,this.setupLevel(),this.player.updateLivesDisplay()}enemiesLeft(){for(let t=0;t<this.enemies.length;t++)if(this.enemies[t])return!0;return!1}removeEnemy(t){for(let e=0;e<this.enemies.length;e++)this.enemies[e]&&this.enemies[e].id===t&&(this.enemies[e].projectiles=[],delete this.enemies[e])}setupLevel(){this.enemies=this.levels[this.levelidx](this.ctx).enemies,this.levelidx++}renderBackground(){this.background.draw()}setupControls(){new n(this.ctx)}addProjectile(t){const e=this.player.fireProjectile();return this.playerProjectiles.push(e),t}addEnemyProjectile(t,e){const i=this.enemies[e].fireProjectile();return this.enemies[e].projectiles.push(i),t}gameOver(){document.getElementById("end-modal").style.display="block",console.log("We here")}startStun(){this.stunTime=10}draw(t){if(this.gameOnGoing){this.startTime=t-this.startTime>300?this.addProjectile(t):this.startTime,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderBackground(),this.player.draw();for(let e=0;e<this.enemies.length;e++)this.enemies[e]&&(this.enemies[e].draw(t),this.enemies[e]&&this.enemies[e].y>0&&(this.enemies[e].time=t-this.enemies[e].time>3e3?this.addEnemyProjectile(t,e):this.enemies[e].time));if(this.playerProjectiles.map(t=>t.draw()),!this.enemiesLeft())return this.gameOnGoing=!1,void this.gameOver();this.animationLoop=requestAnimationFrame(this.draw)}}start(){this.gameOnGoing=!0,this.animationLoop=requestAnimationFrame(this.draw)}pause(){this.animationLoop&&(console.log("GAME SHOULD PAUSE"),cancelAnimationFrame(this.animationLoop)),this.gameOnGoing=!1,this.gameOver()}};let c=null;document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("canvas"),e=t.getContext("2d");c=new d(t,e),window.game=c})}]);
//# sourceMappingURL=main.js.map